<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª - JÅŒ Store</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
<style>
body { font-family:'Cairo',sans-serif; background:#f9f9f9; margin:0; padding:0; direction:rtl; transition:0.3s; }
header, footer { background:#000; color:#fdd835; text-align:center; padding:15px; font-weight:bold; }
button { padding:8px 14px; border:none; border-radius:6px; cursor:pointer; font-weight:bold; transition:0.3s; background:#fdd835; color:#000; }
button:hover { transform:scale(1.05); opacity:0.9; }
.dark-mode { background:#121212; color:#eee; }
.dark-mode header, .dark-mode footer { background:#222; color:#fdd835; }
.dark-mode .product { background:#1e1e1e; border:2px solid #fdd835; color:#fff; }
.dark-mode .color-circle.selected { border:3px solid #fff; box-shadow:0 0 8px #fdd835; }
.dark-mode button { background:#333; color:#fff; border:1px solid #555; }
.dark-mode input[type="number"] { background:#333; color:#fff; border:1px solid #555; }

/* Toast */
.toast { position:fixed; bottom:30px; right:30px; min-width:250px; max-width:320px; background:#333; color:#fff; padding:14px 20px; border-radius:10px; font-size:14px; font-weight:bold; display:flex; align-items:center; gap:10px; opacity:0; transform:translateY(50px) scale(0.8); transition:all 0.4s cubic-bezier(0.25,1,0.5,1); z-index:10000; }
.toast.show { opacity:1; transform:translateY(0) scale(1); }
.toast.success { border-left:5px solid #4caf50; background:#2e7d32; }
.toast.error { border-left:5px solid #f44336; background:#c62828; }
.toast.info { border-left:5px solid #2196f3; background:#1565c0; }

/* Ø±Ø³Ø§Ù„Ø© Ø­Ø°Ù Ø§Ø­ØªØ±Ø§ÙÙŠØ© */
.toast-confirm {
  position: fixed;
  bottom: 30px;
  right: 30px;
  min-width: 250px;
  max-width: 350px;
  background: #ffcc00;
  color: #000;
  padding: 15px 20px;
  border-radius: 12px;
  font-weight: bold;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 10px;
  opacity: 0;
  transform: translateY(50px) scale(0.8);
  transition: all 0.4s cubic-bezier(0.25,1,0.5,1);
  z-index: 10000;
}
.toast-confirm.show {
  opacity: 1;
  transform: translateY(0) scale(1);
}
.toast-confirm button {
  background: #f44336;
  color: #fff;
  border: none;
  padding: 6px 12px;
  border-radius: 8px;
  cursor: pointer;
  font-weight: bold;
  transition: 0.3s;
}
.toast-confirm button:hover { transform: scale(1.1); }

/* Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
.products { display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:20px; padding:20px; }
.product { background:#fff; border:2px solid #fdd835; border-radius:12px; padding:15px; text-align:center; box-shadow:0 4px 12px rgba(0,0,0,0.15); transition:0.3s; }
.product:hover { transform:translateY(-5px); box-shadow:0 10px 20px rgba(0,0,0,0.25); }
.product img { width:100%; height:200px; object-fit:cover; border-radius:8px; transition:0.3s; }
.product img:hover { transform:scale(1.05); }
.product h3 { margin:10px 0; font-size:16px; font-weight:bold; }
.color-options { display:flex; justify-content:center; gap:8px; margin:10px 0; }
.color-circle { width:24px; height:24px; border-radius:50%; cursor:pointer; border:2px solid #ddd; transition:0.2s; }
.color-circle:hover { transform:scale(1.3); box-shadow:0 0 8px rgba(0,0,0,0.3); }
.color-circle.selected { border:3px solid #000; box-shadow:0 0 8px #fdd835; }

/* Ø§Ù„Ø³Ù„Ø© */
.cart { background:#eee; padding:15px; border-radius:12px; margin:20px auto; max-width:500px; }
.dark-mode .cart { background:#333; color:#fff; }
.cart ul { list-style:none; padding:0; }
.cart li { display:flex; justify-content:space-between; align-items:center; margin:10px 0; padding:8px; border-radius:6px; background:#fff; box-shadow:0 2px 5px rgba(0,0,0,0.1); transition:0.3s; }
.dark-mode .cart li { background:#1e1e1e; color:#fff; }
.cart li span.color-circle { margin-left:10px; }
.cart li button { background:#f44336; color:#fff; border-radius:6px; }
.cart li button:hover { background:#e53935; transform:scale(1.05); }
</style>
</head>
<body>
<header>ğŸ›ï¸ Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ JÅŒ Store</header>
<button onclick="toggleMode()">ğŸŒ— ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹</button>
<button onclick="logout()" style="margin-left:10px;">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>

<div class="products" id="products"></div>

<div class="cart" id="cart">
<h3>ğŸ›’ Ø§Ù„Ø³Ù„Ø©</h3>
<ul id="cartItems"></ul>
<button onclick="sendOrder()">ğŸ“© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
</div>

<div id="toast" class="toast"></div>

<script>
let dark=false;
let cart=JSON.parse(localStorage.getItem("cart"))||[];
let products=JSON.parse(localStorage.getItem("products"))||[];
let selectedColors={};

function toggleMode(){ dark=!dark; document.body.classList.toggle("dark-mode"); }

function showToast(msg,type="success"){
  const toast=document.getElementById("toast");
  toast.innerText=msg;
  toast.className=`toast show ${type}`;
  setTimeout(()=>{ toast.className="toast"; },3000);
}

function renderProducts(){
  const container=document.getElementById("products");
  container.innerHTML="";
  products.forEach((p,i)=>{
    let div=document.createElement("div");
    div.className="product";
    div.innerHTML=`
      <img src="${p.image}">
      <h3>${p.name} - ${p.price} EGP</h3>
      <div class="color-options">${p.colors.map(c=>`<span class="color-circle" style="background:${c}" onclick="pickColor(${i},'${c}',this)"></span>`).join("")}</div>
      <label>Ø§Ù„ÙƒÙ…ÙŠØ©: <input type="number" id="qty-${i}" min="1" value="1"></label><br>
      <button onclick="addToCart(${i})">â• Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©</button>
    `;
    container.appendChild(div);
  });
}

function pickColor(index,color,el){
  document.querySelectorAll(`#products .product:nth-child(${index+1}) .color-circle`).forEach(c=>c.classList.remove("selected"));
  el.classList.add("selected");
  selectedColors[index]=color;
}

function addToCart(index){
  let product=products[index];
  let qty=parseInt(document.getElementById(`qty-${index}`).value);
  let color=selectedColors[index]||product.colors[0];
  cart.push({name:product.name,price:product.price,qty,color,image:product.image,availableColors:product.colors});
  localStorage.setItem("cart",JSON.stringify(cart));
  renderCart();
  showToast("âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ù„Ù„Ø³Ù„Ø©","success");
}

function renderCart(){
  let list=document.getElementById("cartItems");
  list.innerHTML="";
  cart.forEach((item,i)=>{
    let li=document.createElement("li");
    li.innerHTML=`
      ${item.name} - ${item.qty} Ù‚Ø·Ø¹Ø©
      <span class="color-circle" style="background:${item.color}" onclick="changeColor(${i})"></span>
      <button onclick="confirmDelete(${i})">ğŸ—‘ï¸</button>
    `;
    list.appendChild(li);
  });
}

function changeColor(i){
  let item=cart[i];
  let colorsHTML=item.availableColors.map(c=>`<span class="color-circle" style="background:${c}" onclick="selectNewColor(${i},'${c}')"></span>`).join("");
  const confirmDiv=document.createElement("div");
  confirmDiv.innerHTML=`<div class="toast info show" style="flex-wrap:wrap; gap:5px;">ğŸ¨ Ø§Ø®ØªØ± Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${colorsHTML}</div>`;
  document.body.appendChild(confirmDiv);
  setTimeout(()=>{ confirmDiv.remove(); },4000);
}

function selectNewColor(i,color){
  cart[i].color=color;
  localStorage.setItem("cart",JSON.stringify(cart));
  renderCart();
  showToast("ğŸ¨ ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„Ù„ÙˆÙ† Ø¨Ù†Ø¬Ø§Ø­","info");
}

// **Ø±Ø³Ø§Ù„Ø© Ø­Ø°Ù Ø§Ø­ØªØ±Ø§ÙÙŠØ©**
function confirmDelete(i){
  const existing=document.querySelector(".toast-confirm");
  if(existing) existing.remove();

  const confirmDiv=document.createElement("div");
  confirmDiv.className="toast-confirm show";
  confirmDiv.innerHTML=`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù "${cart[i].name}" Ù…Ù† Ø§Ù„Ø³Ù„Ø©ØŸ <button onclick="deleteItem(${i},this)">Ø­Ø°Ù</button>`;
  document.body.appendChild(confirmDiv);

  setTimeout(()=>{ confirmDiv.remove(); },5000);
}

function deleteItem(i,btn){
  cart.splice(i,1);
  localStorage.setItem("cart",JSON.stringify(cart));
  renderCart();
  btn.parentElement.remove();
  showToast("ğŸ—‘ï¸ ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬","error");
}

function sendOrder(){
  if(cart.length===0){ showToast("âš ï¸ Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©","error"); return; }
  let message="ğŸ›ï¸ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† JÅŒ Store:%0A";
  cart.forEach(item=>{ message+=`- ${item.name} (${item.qty}) - Ø§Ù„Ù„ÙˆÙ†: ${item.color} - ${item.price} EGP%0A`; });
  let phone="01061024877";
  window.open(`https://wa.me/${phone}?text=${message}`,"_blank");
}

function logout(){ localStorage.removeItem("loggedInUser"); window.location.href="login.html"; }

renderProducts();
renderCart();
</script>
</body>
</html>

